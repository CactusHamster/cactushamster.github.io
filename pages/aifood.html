<head>
	<title>AI Food Maker</title>
</head>

<style>
	body {
		text-align: center
	}
	.formatButton {
		width: 90%;
		height: 12%
	}
	textarea {
		width: 90%;
		height: 40%
	}
</style>

<body>
	<textarea id="input" style="width:90%;"></textarea>
	<br></br>
	<input type="button" class="formatButton" id="Format" value="Format!"></input>
	<br></br>
	<textarea id="output"></textarea>
</body>






<script>
document.getElementById('Format').onclick = function (event) {
	var text = document.getElementById('input').value
	text = text.split('\n'); text.shift(); text.shift(); text.shift(); text = text.join('\n')
	
	var newChunks = []
	
	var chunks = text.split(' â€” ')
	chunks.forEach((chunk, chunkNumber) => {
		if (chunk.replace(/\n/g, '') == '') return;
		var lines = chunk.split('\n')
		var newChunk = []
		if (chunkNumber == 0) {
			newChunk.username = chunk.replace(/\n/g, '')
			newChunks.push(newChunk)
		} else if (chunkNumber == 1) {
			lines.pop()
			lines.pop()
			newChunks[0].text = lines.map(line=>{if (line == '\n') {return '';} else return line}).join('\n')
		} else {
			var lastChunkLines = chunks[chunkNumber-1].split('\n')
			var username = lastChunkLines[lastChunkLines.length-2].replace(/\n/g, '')
			if (username == 'BOT') username = lastChunkLines[lastChunkLines.length-3].replace(/\n/g, '')
			newChunk.username = username
			lines = lines.map(line=>{if (line.replace(/(\n| )/gi) == '') {return '';} else return line})
			lines.pop()
			lines.pop()
			newChunk.text = lines.join('\n')
			console.info(newChunk.username)
			newChunks.push(newChunk)
		}
	})
	text = newChunks.map((object, index) => {
		return object.username+object.text.replace(/((Today|Yesterday) at [0-9]?[0-9]:[0-9]{2} (AM|PM)$|[0-9]{2}\/[0-9]{2}\/[0-9]{4})$/img, '').replace(/^\n$/img, '')
	}).join('\n\n')
	
	
	
	document.getElementById('output').value = text
}
</script>